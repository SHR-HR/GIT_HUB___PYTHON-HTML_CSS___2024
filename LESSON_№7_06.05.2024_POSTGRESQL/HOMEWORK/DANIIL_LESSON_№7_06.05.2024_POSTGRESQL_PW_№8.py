# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
"""""
–î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ü–†–ê–ö–¢–ò–ß–ï–°–ö–û–ô –†–ê–ë–û–¢–´: 06 - 07 –ú–ê–Ø 2024 –≥–æ–¥–∞.
"""""
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
'''
                                              –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ê–Ø –†–ê–ë–û–¢–ê

                                            –ö—É—Ä—Å: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ Python, —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –§—Ä–µ–π–º–≤–æ—Ä–∫–∞ Django
                                                                            –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞: –¢–µ–æ—Ä–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö. PostgreSQL

                                            –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ ‚Ññ8:
                             –ü–æ–Ω—è—Ç–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ú–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.

                                        üëáüèª –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞–Ω–∏—è:

üëâüèª –ó–∞–¥–∞–Ω–∏–µ ‚Ññ 1.
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤, –∏—Ö —Ä–æ–ª—å, –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–æ, —Å—É–º–º–∞ –º–∏–Ω—É—Ç, –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã—Ö –Ω–∞ –ø–æ–ª–µ –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö
–∫–∞—Ä—Ç–æ—á–µ–∫ –∑–∞ –≤–µ—Å—å —Ñ—É—Ç–±–æ–ª—å–Ω—ã–π —Å–µ–∑–æ–Ω.

üëâüèª –ü–æ–ª—è: 
- nickname, 
- role, 
- citizenship, 
- sum_minutes, 
- sum_cards

üëâüèª –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:
- –≥–æ–ª–∫–∏–ø–µ—Ä, –∑–∞—â–∏—Ç–Ω–∏–∫, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫, –Ω–∞–ø–∞–¥–∞—é—â–∏–π;
- –û—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–∏–Ω—É—Ç –Ω–∞ –ø–æ–ª–µ.


üëâüèª –ó–∞–¥–∞–Ω–∏–µ ‚Ññ 2.
–°–æ–∑–¥–∞—Ç—å –æ–¥–Ω–æ –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∏ –æ–¥–Ω–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.


üëâüèª –ó–∞–¥–∞–Ω–∏–µ ‚Ññ 3.
–ò–∑–º–µ–Ω–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç —É –∏–≥—Ä–æ–∫–∞ ¬´–ê.Becker¬ª –≤ –∏–≥—Ä–µ ‚Ññ1 —Å 90 –º–∏–Ω—É—Ç –Ω–∞ 120 –∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
–≤ –æ–±–æ–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö.
'''
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
'''
–£—Ä–æ–∫ –æ—Ç 06.05.2024 - —É—á–∏—Ç–µ–ª—å –•—É—Å–Ω—É–ª–ª–∏–Ω –î–∞–Ω–∏–∏–ª –î–µ–Ω–∏—Å–æ–≤–∏—á.
'''
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –î–õ–Ø –ù–ê–ß–ê–õ–ê - –ø–æ—á–µ–º—É my_pw_ls_71_db?
# my - –º–æ—è
# pw - –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞
# ls - —É—Ä–æ–∫ ‚Ññ
# 7 - 7
# 1 - –≤–∞—Ä–∏–∞–Ω—Ç 1
# db - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #



import psycopg2
from psycopg2 import sql

def create_database():
    try:
        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É PostgreSQL
        connection = psycopg2.connect(
            host="localhost",
            user="postgres",
            password="admin",
            port="5432"
        )

        # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
        connection.set_isolation_level(psycopg2.extensions.ISOLATION_LEVEL_AUTOCOMMIT)

        cursor = connection.cursor()

        # –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        create_database_query = sql.SQL("CREATE DATABASE {}").format(sql.Identifier("my_pw_ls_71_db"))
        cursor.execute(create_database_query)

        print("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞.")

    except psycopg2.Error as e:
        print("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db:", e)
    finally:
        if connection:
            cursor.close()
            connection.close()

# –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
create_database()

def create_players_table():
    try:
        connection = psycopg2.connect(
            database="my_pw_ls_71_db",
            host="localhost",
            user="postgres",
            password="admin",
            port="5432"
        )

        cursor = connection.cursor()

        create_table_query = """
            CREATE TABLE IF NOT EXISTS Players (
                id SERIAL PRIMARY KEY,
                nickname VARCHAR(50) NOT NULL,
                player_number INT NOT NULL,
                role VARCHAR(50) NOT NULL,
                citizenship VARCHAR(50) NOT NULL,
                sum_minutes INT NOT NULL,
                sum_cards INT NOT NULL
            );
        """
        cursor.execute(create_table_query)
        connection.commit()

        print("–¢–∞–±–ª–∏—Ü–∞ Players —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞.")

        # –î–æ–±–∞–≤–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É
        insert_data_query = """
            INSERT INTO Players (nickname, player_number, role, citizenship, sum_minutes, sum_cards)
            VALUES
                ('Ivan_Ivan', 1, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'Russia', 90, 2),
                ('Rio_Carnavele', 2, '–∑–∞—â–∏—Ç–Ω–∏–∫', 'Brazil', 90, 1),
                ('Hitler_Kaput', 3, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Germany', 90, 1),
                ('Ole_Ole_Ole', 4, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Argentina', 90, 0),
                ('Zorro', 5, '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫', 'Spain', 90, 2),
                ('Kruasan', 6, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'France', 90, 1),
                ('Spagetti_Borgia', 7, '–∑–∞—â–∏—Ç–Ω–∏–∫', 'Italy', 90, 2),
                ('Big_Ben_Booom', 8, '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫', 'England', 90, 1),
                ('Ronaldo', 9, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'Portugal', 90, 0),
                ('–ê.Becker', 10, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Netherlands', 90, 1);
        """
        cursor.execute(insert_data_query)
        connection.commit()

        print("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É Players.")

    except psycopg2.Error as e:
        print("–û—à–∏–±–∫–∞:", e)
    finally:
        if connection:
            cursor.close()
            connection.close()

# –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
create_players_table()

def task_1():
    try:
        connection = psycopg2.connect(
            database="my_pw_ls_71_db",
            host="localhost",
            user="postgres",
            password="admin",
            port="5432"
        )

        cursor = connection.cursor()

        # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
        get_players_query = """
            SELECT nickname, role, citizenship, sum_minutes, sum_cards
            FROM Players
            ORDER BY
                CASE role
                    WHEN '–≥–æ–ª–∫–∏–ø–µ—Ä' THEN 1
                    WHEN '–∑–∞—â–∏—Ç–Ω–∏–∫' THEN 2
                    WHEN '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫' THEN 3
                    WHEN '–Ω–∞–ø–∞–¥–∞—é—â–∏–π' THEN 4
                END,
                sum_minutes DESC;
        """
        cursor.execute(get_players_query)
        players = cursor.fetchall()

        print("\n–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤:")
        for player in players:
            print(player)

    except psycopg2.Error as e:
        print("–û—à–∏–±–∫–∞:", e)
    finally:
        if connection:
            cursor.close()
            connection.close()

# –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è ‚Ññ 1
task_1()

def create_views():
    try:
        connection = psycopg2.connect(
            database="my_pw_ls_71_db",
            host="localhost",
            user="postgres",
            password="admin",
            port="5432"
        )

        cursor = connection.cursor()

        # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
        create_simple_view_query = """
            CREATE OR REPLACE VIEW Players_View AS
            SELECT * FROM Players;
        """
        cursor.execute(create_simple_view_query)
        connection.commit()

        # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
        create_materialized_view_query = """
            CREATE MATERIALIZED VIEW Players_Materialized_View AS
            SELECT * FROM Players;
        """
        cursor.execute(create_materialized_view_query)
        connection.commit()

        print("–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã.")

    except psycopg2.Error as e:
        print("–û—à–∏–±–∫–∞:", e)
    finally:
        if connection:
            cursor.close()
            connection.close()

# –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
create_views()

def update_minutes():
    try:
        connection = psycopg2.connect(
            database="my_pw_ls_71_db",
            host="localhost",
            user="postgres",
            password="admin",
            port="5432"
        )

        cursor = connection.cursor()

        # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
        update_minutes_query = """
            UPDATE Players
            SET sum_minutes = 120
            WHERE nickname = '–ê.Becker' AND player_number = 10;
        """
        cursor.execute(update_minutes_query)
        connection.commit()

        print("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")

    except psycopg2.Error as e:
        print("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:", e)
    finally:
        if connection:
            cursor.close()
            connection.close()

# –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω—É—Ç
update_minutes()
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
'''
–®–∞–≥ –∑–∞ —à–∞–≥–æ–º. –†–∞–∑–±–æ—Ä –∫–æ–¥–∞, –¥–ª—è –í–∞—Å –∏ –¥–ª—è –º–µ–Ω—è —Å–∞–º–æ–≥–æ –≤ –±—É–¥—É—â–µ–º. –í–µ–¥—å —è —Å–µ–π—á–∞—Å, –Ω–µ —è —á–µ—Ä–µ–∑ –ø–æ–ª –≥–æ–¥–∞.
'''
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #


# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –®–∞–≥ ‚Ññ1. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –ó–∞–≥–ª–∞–≤–ª–µ–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

# def create_database():
#     try:
#         # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É PostgreSQL
#         connection = psycopg2.connect(
#             host="localhost",
#             user="postgres",
#             password="admin",
#             port="5432"
#         )
#
#         # –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
#         connection.set_isolation_level(psycopg2.extensions.ISOLATION_LEVEL_AUTOCOMMIT)
#
#         cursor = connection.cursor()
#
#         # –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
#         create_database_query = sql.SQL("CREATE DATABASE {}").format(sql.Identifier("my_pw_ls_71_db"))
#         cursor.execute(create_database_query)
#
#         print("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞.")
#
#     except psycopg2.Error as e:
#         print("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö my_pw_ls_71_db:", e)
#     finally:
#         if connection:
#             cursor.close()
#             connection.close()
#
# # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
# create_database()

# –û–ø–∏—Å–∞–Ω–∏–µ:
# –≠—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º "my_pw_ls_71_db" –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ PostgreSQL,
# –µ—Å–ª–∏ —Ç–∞–∫–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –µ—â–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.


# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –®–∞–≥ ‚Ññ2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–æ–∫–æ–≤:
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –ó–∞–≥–ª–∞–≤–ª–µ–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏–≥—Ä–æ–∫–æ–≤.

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

# def create_players_table():
#     try:
#         connection = psycopg2.connect(
#             database="my_pw_ls_71_db",
#             host="localhost",
#             user="postgres",
#             password="admin",
#             port="5432"
#         )
#
#         cursor = connection.cursor()
#
#         create_table_query = """
#             CREATE TABLE IF NOT EXISTS Players (
#                 id SERIAL PRIMARY KEY,
#                 nickname VARCHAR(50) NOT NULL,
#                 player_number INT NOT NULL,
#                 role VARCHAR(50) NOT NULL,
#                 citizenship VARCHAR(50) NOT NULL,
#                 sum_minutes INT NOT NULL,
#                 sum_cards INT NOT NULL
#             );
#         """
#         cursor.execute(create_table_query)
#         connection.commit()
#
#         print("–¢–∞–±–ª–∏—Ü–∞ Players —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞.")
#
#         # –î–æ–±–∞–≤–∏–º –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü—É
#         insert_data_query = """
#             INSERT INTO Players (nickname, player_number, role, citizenship, sum_minutes, sum_cards)
#             VALUES
#                 ('Ivan_Ivan', 1, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'Russia', 90, 2),
#                 ('Rio_Carnavele', 2, '–∑–∞—â–∏—Ç–Ω–∏–∫', 'Brazil', 90, 1),
#                 ('Hitler_Kaput', 3, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Germany', 90, 1),
#                 ('Ole_Ole_Ole', 4, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Argentina', 90, 0),
#                 ('Zorro', 5, '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫', 'Spain', 90, 2),
#                 ('Kruasan', 6, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'France', 90, 1),
#                 ('Spagetti_Borgia', 7, '–∑–∞—â–∏—Ç–Ω–∏–∫', 'Italy', 90, 2),
#                 ('Big_Ben_Booom', 8, '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫', 'England', 90, 1),
#                 ('Ronaldo', 9, '–≥–æ–ª–∫–∏–ø–µ—Ä', 'Portugal', 90, 0),
#                 ('–ê.Becker', 10, '–Ω–∞–ø–∞–¥–∞—é—â–∏–π', 'Netherlands', 90, 1);
#         """
#         cursor.execute(insert_data_query)
#         connection.commit()
#
#         print("–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Ç–∞–±–ª–∏—Ü—É Players.")
#
#     except psycopg2.Error as e:
#         print("–û—à–∏–±–∫–∞:", e)
#     finally:
#         if connection:
#             cursor.close()
#             connection.close()
#
# # –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –∏ –¥–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
# create_players_table()

# –û–ø–∏—Å–∞–Ω–∏–µ:
# –≠—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É "Players" –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö "my_pw_ls_71_db" –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —ç—Ç—É —Ç–∞–±–ª–∏—Ü—É.
# –¢–∞–±–ª–∏—Ü–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ—É—Ç–±–æ–ª—å–Ω—ã—Ö –∏–≥—Ä–æ–∫–∞—Ö, —Ç–∞–∫—É—é –∫–∞–∫ –∏—Ö –ø—Å–µ–≤–¥–æ–Ω–∏–º—ã, –Ω–æ–º–µ—Ä–∞ –∏–≥—Ä–æ–∫–æ–≤, —Ä–æ–ª–∏, –≥—Ä–∞–∂–¥–∞–Ω—Å—Ç–≤–∞,
# —Å—É–º–º–∞—Ä–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –∏–≥—Ä—ã –∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∂–µ–ª—Ç—ã—Ö –∫–∞—Ä—Ç–æ—á–µ–∫.


# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –®–∞–≥ ‚Ññ3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è ‚Ññ 1:
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –ó–∞–≥–ª–∞–≤–ª–µ–Ω–∏–µ: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è ‚Ññ 1.

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

# def task_1():
#     try:
#         connection = psycopg2.connect(
#             database="my_pw_ls_71_db",
#             host="localhost",
#             user="postgres",
#             password="admin",
#             port="5432"
#         )
#
#         cursor = connection.cursor()
#
#         # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ —Å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–æ–π
#         get_players_query = """
#             SELECT nickname, role, citizenship, sum_minutes, sum_cards
#             FROM Players
#             ORDER BY
#                 CASE role
#                     WHEN '–≥–æ–ª–∫–∏–ø–µ—Ä' THEN 1
#                     WHEN '–∑–∞—â–∏—Ç–Ω–∏–∫' THEN 2
#                     WHEN '—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫' THEN 3
#                     WHEN '–Ω–∞–ø–∞–¥–∞—é—â–∏–π' THEN 4
#                 END,
#                 sum_minutes DESC;
#         """
#         cursor.execute(get_players_query)
#         players = cursor.fetchall()
#
#         print("\n–°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤:")
#         for player in players:
#             print(player)
#
#     except psycopg2.Error as e:
#         print("–û—à–∏–±–∫–∞:", e)
#     finally:
#         if connection:
#             cursor.close()
#             connection.close()
#
# # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è ‚Ññ 1
# task_1()

# –û–ø–∏—Å–∞–Ω–∏–µ:
# –≠—Ç–æ—Ç –∫–æ–¥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞–Ω–∏–µ ‚Ññ 1, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –≤—ã–≤–æ–¥–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã "Players"
# –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö "my_pw_ls_71_db".
# –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ —Ä–æ–ª—è–º (–≥–æ–ª–∫–∏–ø–µ—Ä, –∑–∞—â–∏—Ç–Ω–∏–∫, —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –ø–æ–ª—É–∑–∞—â–∏—Ç–Ω–∏–∫, –Ω–∞–ø–∞–¥–∞—é—â–∏–π)
# –∏ –æ–±—â–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –º–∏–Ω—É—Ç –∏–≥—Ä—ã –≤ —É–±—ã–≤–∞—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ.


# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –®–∞–≥ ‚Ññ4. –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π:
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –ó–∞–≥–ª–∞–≤–ª–µ–Ω–∏–µ: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

# def create_views():
#     try:
#         connection = psycopg2.connect(
#             database="my_pw_ls_71_db",
#             host="localhost",
#             user="postgres",
#             password="admin",
#             port="5432"
#         )
#
#         cursor = connection.cursor()
#
#         # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
#         create_simple_view_query = """
#             CREATE OR REPLACE VIEW Players_View AS
#             SELECT * FROM Players;
#         """
#         cursor.execute(create_simple_view_query)
#         connection.commit()
#
#         # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
#         create_materialized_view_query = """
#             CREATE MATERIALIZED VIEW Players_Materialized_View AS
#             SELECT * FROM Players;
#         """
#         cursor.execute(create_materialized_view_query)
#         connection.commit()
#
#         print("–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω—ã.")
#
#     except psycopg2.Error as e:
#         print("–û—à–∏–±–∫–∞:", e)
#     finally:
#         if connection:
#             cursor.close()
#             connection.close()
#
# # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π
# create_views()

# –û–ø–∏—Å–∞–Ω–∏–µ:
# –≠—Ç–æ—Ç –∫–æ–¥ —Å–æ–∑–¥–∞–µ—Ç –¥–≤–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö "my_pw_ls_71_db".
# –ü–µ—Ä–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º (–Ω–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º) –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã "Players".
# –í—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è –º–∞—Ç–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º –∏ —Ç–∞–∫–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã "Players".


# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –®–∞–≥ ‚Ññ5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω—É—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞:
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –ó–∞–≥–ª–∞–≤–ª–µ–Ω–∏–µ: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω—É—Ç –¥–ª—è –∏–≥—Ä–æ–∫–∞.

# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞:

# def update_minutes():
#     try:
#         connection = psycopg2.connect(
#             database="my_pw_ls_71_db",
#             host="localhost",
#             user="postgres",
#             password="admin",
#             port="5432"
#         )
#
#         cursor = connection.cursor()
#
#         # SQL-–∑–∞–ø—Ä–æ—Å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
#         update_minutes_query = """
#             UPDATE Players
#             SET sum_minutes = 120
#             WHERE nickname = '–ê.Becker' AND player_number = 10;
#         """
#         cursor.execute(update_minutes_query)
#         connection.commit()
#
#         print("–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–æ.")
#
#     except psycopg2.Error as e:
#         print("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö:", e)
#     finally:
#         if connection:
#             cursor.close()
#             connection.close()
#
# # –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–∏–Ω—É—Ç
# update_minutes()

# –û–ø–∏—Å–∞–Ω–∏–µ:
# –≠—Ç–æ—Ç –∫–æ–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç –∏–≥—Ä—ã –¥–ª—è –∏–≥—Ä–æ–∫–∞ —Å –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–º '–ê.Becker' –∏ –Ω–æ–º–µ—Ä–æ–º –∏–≥—Ä–æ–∫–∞ 10 –≤ —Ç–∞–±–ª–∏—Ü–µ "Players".
# –ù–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∏–Ω—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —Ä–∞–≤–Ω—ã–º 120.
# ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ #
# –°–ü–ê–°–ò–ë–û –∑–∞ –≤–Ω–∏–º–∞–Ω–∏–µ! –ù–∞–¥–µ—é—Å—å, —á—Ç–æ –í—ã –ø–æ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤—É –æ—Ü–µ–Ω–∏—Ç–µ –¥–∞–Ω–Ω—É—é –ü–†–ê–ö–¢–ò–ß–ï–°–ö–£–Æ –†–ê–ë–û–¢–£ ‚Ññ8 - –æ—Ç 06.05.2024-07.05.2024